{% extends "base.html" %}

{% block title %}Content Preview - Dylan's Content Agent{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-eye me-2"></i>Content Preview
                </h5>
            </div>
            <div class="card-body">
                <h4 class="text-primary mb-3">{{ item.title }}</h4>
                
                <!-- Content Metadata -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <small class="text-muted">Type</small>
                        <div class="fw-bold">{{ item.type.replace('_', ' ').title() }}</div>
                    </div>
                    <div class="col-md-3">
                        <small class="text-muted">Word Count</small>
                        <div class="fw-bold">{{ item.word_count }} words</div>
                    </div>
                    <div class="col-md-3">
                        <small class="text-muted">Topics</small>
                        <div class="fw-bold">{{ item.topics }}</div>
                    </div>
                    <div class="col-md-3">
                        <small class="text-muted">Created</small>
                        <div class="fw-bold">{{ item.created }}</div>
                    </div>
                </div>
                
                <!-- Content Body -->
                <div class="content-preview p-4 mb-4 border rounded" style="background-color: #f8f9fa; line-height: 1.6;">
                    <div class="content-text">
                        {% if item.full_content %}
                            {{ item.full_content|replace('\n\n', '</p><p>')|replace('\n', '<br>')|safe }}
                        {% else %}
                            {{ item.preview|replace('\n\n', '</p><p>')|replace('\n', '<br>')|safe }}
                        {% endif %}
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="d-flex gap-2">
                    <a href="{{ url_for('content_queue') }}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Back to Queue
                    </a>
                    <button class="btn btn-success" onclick="postToLinkedIn()">
                        <i class="fab fa-linkedin me-2"></i>Post to LinkedIn
                    </button>
                    <button class="btn btn-info" onclick="copyToClipboard()">
                        <i class="fas fa-copy me-2"></i>Copy Content
                    </button>
                    <a href="{{ url_for('generate_content') }}" class="btn btn-primary">
                        <i class="fas fa-magic me-2"></i>Generate New
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Content Guidelines
                </h5>
            </div>
            <div class="card-body">
                <ul class="list-unstyled">
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <small>Professional CRE tone maintained</small>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <small>Data-driven insights included</small>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <small>Engagement question present</small>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <small>Professional disclaimer added</small>
                    </li>
                    <li class="mb-2">
                        <i class="fas fa-check text-success me-2"></i>
                        <small>Dylan's voice and expertise</small>
                    </li>
                </ul>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-share-alt me-2"></i>Posting Options
                </h5>
            </div>
            <div class="card-body">
                <p class="text-muted mb-3">Choose how to share this content:</p>
                
                <div class="d-grid gap-2">
                    <button class="btn btn-outline-primary" onclick="postToLinkedIn()">
                        <i class="fab fa-linkedin me-2"></i>Post to LinkedIn
                    </button>
                    <button class="btn btn-outline-info" onclick="postToTwitter()">
                        <i class="fab fa-twitter me-2"></i>Post to Twitter
                    </button>
                    <button class="btn btn-outline-secondary" onclick="copyToClipboard()">
                        <i class="fas fa-copy me-2"></i>Copy for Manual Posting
                    </button>
                </div>
                
                <div class="mt-3">
                    <small class="text-muted">
                        <i class="fas fa-info-circle me-1"></i>
                        Manual copying allows you to post to any platform
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Hidden textarea for copying -->
<textarea id="contentText" style="position: absolute; left: -9999px;">{{ item.preview }}</textarea>
{% endblock %}

{% block scripts %}
<script>
    function postToLinkedIn() {
        if (confirm('Post this content to LinkedIn?')) {
            // This would integrate with the posting system
            alert('LinkedIn posting feature requires API configuration. For now, please copy the content and post manually.');
        }
    }
    
    function postToTwitter() {
        if (confirm('Post this content to Twitter?')) {
            // This would integrate with the posting system
            alert('Twitter posting feature requires API configuration. For now, please copy the content and post manually.');
        }
    }
    
    function copyToClipboard() {
        const textArea = document.getElementById('contentText');
        textArea.select();
        textArea.setSelectionRange(0, 99999); // For mobile devices
        
        try {
            document.execCommand('copy');
            alert('Content copied to clipboard! You can now paste it into LinkedIn or any other platform.');
        } catch (err) {
            console.error('Failed to copy text: ', err);
            alert('Failed to copy content. Please select and copy the text manually.');
        }
    }
</script>
{% endblock %}
